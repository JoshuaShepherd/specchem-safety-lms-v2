# Check-in: Type Contracts & Validation Health

## DTO & Contract System Assessment

**Required Context Files:**
- `packages/contracts/src/index.ts` - All DTO schemas and types
- `packages/contracts/dist/` - Built contract types
- `apps/crm/src/lib/mappers/` - Data mapper functions
- `apps/crm/src/lib/validations/` - Validation schemas
- `@platform/testing` - Test fixtures and validation tests
- `apps/crm/src/app/api/` - API route implementations
- `packages/shared/src/index.ts` - Shared utilities

**Cursor Prompt:**

```
Perform a comprehensive validation of our Safety Training type contracts, DTOs, and validation system:

1. **Zod Schema Validation:**
   - Test that all DTO schemas parse successfully with fixture data
   - Run `npm test` in @platform/testing to verify all fixtures pass schema validation
   - Check that TypeScript types are correctly generated from Zod schemas
   - Verify schema validation catches invalid data appropriately
   - Test that custom validation functions work correctly

2. **Data Mapper Testing:**
   - Test all transformation paths: DB → DTO, DTO → DB, Form → DTO
   - Verify null/undefined handling in all mappers
   - Check date/time transformations (ISO strings, timezone handling)
   - Test plant and role-based field filtering
   - Validate error handling in mapper functions

3. **API Contract Verification:**
   - Verify all endpoint contracts have request/response schemas
   - Test ingress validation (request parsing with Zod)
   - Test egress validation (response parsing with Zod)
   - Check error response formats match shared error taxonomy
   - Validate pagination contracts are consistent

4. **Type Safety Assessment:**
   - Run TypeScript strict mode compilation on all contract packages
   - Verify no `any` types are used in contracts or mappers
   - Check that all API endpoints have proper type definitions
   - Test that form validation schemas align with API contracts
   - Validate shared types are properly exported and imported

5. **Fixture & Testing Infrastructure:**
   - Verify each Response DTO has corresponding test fixtures
   - Check that fixtures represent realistic data scenarios
   - Test that CI will fail if DTOs change without fixture updates
   - Validate test utilities and helpers are working
   - Check mock data generation for development

**Generate a Safety Training contracts health report with:**
- 🔧 Schema validation results (pass/fail for each Safety Training entity)
- 🔄 Mapper transformation test results
- 📡 API contract coverage and validation status
- 🎯 Type safety score (% of code with proper types)
- 🧪 Test fixture coverage and quality
- ⚠️ Any validation gaps or type safety issues
- 📋 Recommendations for improving contract robustness
- 🚀 Readiness score for Safety Training API development

Include examples of how to fix any identified type safety or validation issues.
```

**Expected Output:**
- Complete type contracts health assessment
- Schema validation test results
- Mapper functionality verification
- Type safety metrics and recommendations
- Contract coverage analysis

**When to Use This Check-in:**
- After completing steps 07-09 (type contracts)
- Before starting API route development
- When experiencing validation or type errors
- After adding new entities or changing schemas

---

**Next Phase:** If contracts are solid ✅, proceed to `10-authentication-system.md`
**If Issues:** Fix validation and type safety before building APIs